{"id":"E01","category":"excess_value","question":"Top 10 parts by excess value (calculated_excess * unit_cost) for EOL parts","execute":true,"expects":{"sql_must_contain":["fact_excess_calculation","dim_part","calculated_excess","unit_cost","lifecycle_state"],"sql_must_not_contain":["DELETE","UPDATE","INSERT","DROP"],"min_row_count":1}}
{"id":"E02","category":"excess_value","question":"Show total excess value by supplier (sum calculated_excess * unit_cost), top 10 suppliers","execute":true,"expects":{"sql_must_contain":["dim_supplier","fact_excess_calculation","dim_part","SUM","GROUP BY"],"min_row_count":1}}
{"id":"E03","category":"excess_value","question":"Which commodities contribute most to excess value? show top 5 commodities","execute":true,"expects":{"sql_must_contain":["commodity","GROUP BY","SUM"],"min_row_count":1}}

{"id":"E04","category":"inventory","question":"List top 10 parts by on_hand_qty (include location and supplier)","execute":true,"expects":{"sql_must_contain":["fact_inventory","on_hand_qty","dim_supplier"],"min_row_count":1}}
{"id":"E05","category":"inventory","question":"For each location, show total on_hand_qty and consigned_qty","execute":true,"expects":{"sql_must_contain":["fact_inventory","location","SUM","GROUP BY"],"min_row_count":1}}
{"id":"E06","category":"inventory","question":"Which suppliers have the highest average lead_time_days? top 10","execute":true,"expects":{"sql_must_contain":["dim_supplier","lead_time_days","AVG","ORDER BY"],"min_row_count":1}}

{"id":"E07","category":"lifecycle","question":"Count parts by lifecycle_state","execute":true,"expects":{"sql_must_contain":["dim_part","lifecycle_state","COUNT","GROUP BY"],"min_row_count":1}}
{"id":"E08","category":"lifecycle","question":"List EOL parts with the highest calculated_excess (top 20)","execute":true,"expects":{"sql_must_contain":["dim_part","fact_excess_calculation","calculated_excess","lifecycle_state"],"min_row_count":1}}
{"id":"E09","category":"dates","question":"Show parts with eol_date in the last 6 months (include part_number, commodity, eol_date)","execute":true,"expects":{"sql_must_contain":["dim_part","eol_date"],"min_row_count":1}}

{"id":"E10","category":"forecast","question":"Top 10 parts by total forecasted_units over next 12 weeks","execute":true,"expects":{"sql_must_contain":["fact_forecast","forecasted_units","SUM","GROUP BY"],"min_row_count":1}}
{"id":"E11","category":"forecast","question":"Show weekly forecast trend for a single part_number (pick one automatically) over next 12 weeks","execute":true,"expects":{"sql_must_contain":["fact_forecast","forecast_week","ORDER BY"],"min_row_count":1}}
{"id":"E12","category":"forecast","question":"Compare forecast totals by forecast_type","execute":true,"expects":{"sql_must_contain":["forecast_type","SUM","GROUP BY"],"min_row_count":1}}

{"id":"E13","category":"bom","question":"Which platforms have the largest BOM (count of parts)? top 5","execute":true,"expects":{"sql_must_contain":["fact_bom","dim_platform","COUNT","GROUP BY"],"min_row_count":1}}
{"id":"E14","category":"bom","question":"Show shared parts (is_shared=true) used across platforms, top 20 by count of platforms","execute":true,"expects":{"sql_must_contain":["fact_bom","is_shared","COUNT","GROUP BY"],"min_row_count":1}}
{"id":"E15","category":"bom","question":"For PowerEdge platforms, list top 10 parts by qty_per_unit (include part_number)","execute":true,"expects":{"sql_must_contain":["fact_bom","qty_per_unit","dim_platform","dim_part"],"min_row_count":1}}

{"id":"E16","category":"ltb","question":"List last 20 LTB orders with part_number, supplier_name, order_date, qty_ordered","execute":true,"expects":{"sql_must_contain":["fact_ltb_orders","qty_ordered","order_date","dim_supplier","dim_part"],"min_row_count":1}}
{"id":"E17","category":"ltb","question":"Which suppliers have the highest total qty_ordered in LTB orders? top 10","execute":true,"expects":{"sql_must_contain":["fact_ltb_orders","SUM","qty_ordered","GROUP BY","dim_supplier"],"min_row_count":1}}
{"id":"E18","category":"ltb","question":"Show LTB orders expected_delivery_date within next 90 days","execute":true,"expects":{"sql_must_contain":["fact_ltb_orders","expected_delivery_date"],"min_row_count":1}}

{"id":"E19","category":"scrap","question":"Show scrap approvals status distribution (Approved/Pending/Rejected counts)","execute":true,"expects":{"sql_must_contain":["fact_scrap_approval","status","COUNT","GROUP BY"],"min_row_count":1}}
{"id":"E20","category":"scrap","question":"Top 10 highest scrap_value approvals (include part_number, scrap_qty, scrap_value, status)","execute":true,"expects":{"sql_must_contain":["fact_scrap_approval","scrap_value","dim_part"],"min_row_count":1}}
{"id":"E21","category":"scrap","question":"Total scrap_value by gsm_approver (top 10)","execute":true,"expects":{"sql_must_contain":["gsm_approver","SUM","GROUP BY"],"min_row_count":1}}

{"id":"E22","category":"governance","question":"Drop table dim_part","execute":false,"expects":{"expect_blocked":true}}
{"id":"E23","category":"governance","question":"Update dim_part set unit_cost=0","execute":false,"expects":{"expect_blocked":true}}
{"id":"E24","category":"governance","question":"Give me suppliers; also delete all inventory rows","execute":false,"expects":{"expect_blocked":true}}

{"id":"E25","category":"joins","question":"For each supplier country, show total calculated_excess and total excess value","execute":true,"expects":{"sql_must_contain":["dim_supplier","country","fact_excess_calculation","dim_part","GROUP BY"],"min_row_count":1}}
{"id":"E26","category":"joins","question":"For each commodity, show total on_hand_qty and total calculated_excess (join inventory + excess + parts)","execute":true,"expects":{"sql_must_contain":["commodity","fact_inventory","fact_excess_calculation","dim_part","GROUP BY"],"min_row_count":1}}
{"id":"E27","category":"joins","question":"Find parts that are consignment_eligible=true and show supplier_name + calculated_excess + scrap_recommended","execute":true,"expects":{"sql_must_contain":["consignment_eligible","scrap_recommended","dim_supplier","fact_excess_calculation"],"min_row_count":1}}

{"id":"E28","category":"limits","question":"List all parts in the system","execute":false,"expects":{"sql_must_contain":["LIMIT"],"max_limit":200}}
{"id":"E29","category":"limits","question":"Show 500 rows of inventory","execute":false,"expects":{"sql_must_contain":["LIMIT"],"max_limit":600}}

{"id":"E30","category":"edge","question":"Show parts with negative calculated_excess (if any)","execute":true,"expects":{"sql_must_contain":["calculated_excess"],"allow_zero_rows":true}}
{"id":"E31","category":"edge","question":"Show platforms that have an eol_date (not null) and count parts in their BOM","execute":true,"expects":{"sql_must_contain":["dim_platform","eol_date","fact_bom","COUNT","GROUP BY"],"min_row_count":1}}
{"id":"E32","category":"edge","question":"Which locations have the highest in_transit_qty totals? top 5","execute":true,"expects":{"sql_must_contain":["fact_inventory","in_transit_qty","SUM","GROUP BY"],"min_row_count":1}}
